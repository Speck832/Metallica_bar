<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metallica Bar</title>
    <link rel="stylesheet" href="./bar.css">
    <link rel="icon" href="./stickers-logo-metallica.png" type="image/x-icon" sizes="16x16">
    <link rel="stylesheet" href="./mediaqueries.css">
</head>
<body id="body">
    <header class="header">
        <h1 align="center" class="titre">Metallica bar - Carte</h1>
    </header>
    <section>
    <section id="navs">
    <div id="Fuel" class="nav">
        <h4 align="center" class="titrenav">Fuel</h4>
        <a href="./animation.html">
        <img id="a" class="imagenav" src="./stickers-logo-metallica.jpg" alt="image">
        </a>
        <p class="txt">Un cocktail √† base de whisky et de citron, pour ceux qui ne craignent rien !</p>
    </div>
    <div id="VO" class="nav">
        <h4 align="center" class="titrenav">V.O.</h4>
        <a href="./b.html">
        <img id="b" class="imagenav" src="./stickers-logo-metallica.jpg" alt="image">
        </a>
        <p class="txt">Un cocktail dans sa version... originale ! Non plus s√©rieusement, V.O. c'est pour Vodka Orange.</p>
    </div>
    <div id="Guinness" class="nav">
        <h4 id="Guinness2" align="center" class="titrenav">Guinness</h4>
        <a href="./c.html">
        <img id="c" class="imagenav" src="./stickers-logo-metallica.jpg" alt="image">
        </a>
        <p class="txt">Un cocktail d√©licieux avec des touches de grenadine dans une bonne Guinness.</p>
    </div>
    <div id="Bambou" class="nav">
        <h4 align="center" class="titrenav">Bambou</h4>
        <a href="./d.html">
        <img id="d" class="imagenav" src="./stickers-logo-metallica.jpg" alt="image">
        </a>
        <p class="txt">Un cocktail signature du bar, qui revient en force avec ses ar√¥mes de banane et de citron vert !</p>
    </div>
    <div id="Whiskas" class="nav">
        <h4 align="center" id="wh" class="titrenav">Whiskas</h4>
        <a href="./e.html">
        <img id="e" class="imagenav" src="./stickers-logo-metallica.jpg" alt="image">
        </a>
        <p class="txt">Un cocktail pour les fans de chats ! (Vous en faites pas c'est du whisky coca pas de la pat√©e).</p>
    </div>
    <div id="Mojito" class="nav">
        <h4 align="center" class="titrenav">Mojito</h4>
        <a href="./f.html">
        <img id="f" class="imagenav" src="./stickers-logo-metallica.jpg" alt="image">
        </a>
        <p class="txt">Un cocktail d√©licieux avec des touches de citron vert et de menthe.</p>
    </div>
    <div id="Monaco" class="nav">
        <h4 align="center" class="titrenav">Monaco</h4>
        <a href="./g.html">
        <img id="g" class="imagenav" src="./stickers-logo-metallica.jpg" alt="image">
        </a>
        <p class="txt">Un classique √† base de grenadine, de limonade et de bi√®re.</p>
    </div>
    <div id="Enter_Sandman" class="nav">
        <h4 align="center" class="titrenav">Enter Sandman</h4>
        <a href="./h.html">
        <img id="h" class="imagenav" src="./stickers-logo-metallica.jpg" alt="image">
        </a>
        <p class="txt">Un cocktail √† base de Rhum, pomme, miel et √©pices.</p>
    </div>
    <div id="Reload" class="nav">
        <h4 align="center" class="titrenav">Reload</h4>
        <a href="./i.html">
        <img id="i" class="imagenav" src="./stickers-logo-metallica.jpg" alt="image">
        </a>
        <p class="txt">Un cocktail d√©licieux aux ar√¥mes de poire, pomme et √©rable.</p>
    </div>
    <div id="nothing_else_matters" class="nav">
        <h4 align="center" class="titrenav">Nothing else matters</h4>
        <a href="./j.html">
        <img id="j" class="imagenav" src="./stickers-logo-metallica.jpg" alt="image">
        </a>
        <p class="txt">Un cocktail d√©licieux √† l'amande, √† la vanille et √† la grenadine.</p>
    </div>
    <div id="diabolo" class="nav">
        <h4 align="center" class="titrenav">Diabolo</h4>
        <a href="./k.html">
        <img id="k" class="imagenav" src="./stickers-logo-metallica.jpg" alt="image">
        </a>
        <p class="txt">Un cocktail d√©licieux avec des go√ªts vari√©s.</p>
    </div>
    <div id="lifeblood" class="nav">
        <h4 align="center" class="titrenav">Lifeblood</h4>
        <a href="./m.html">
        <img id="m" class="imagenav" src="./stickers-logo-metallica.jpg" alt="image">
        </a>
        <p class="txt">Un cocktail d√©licieux aux go√ªts et √† l'aspect d√©boussolants.</p>
    </div>
    <div id="sadbuttrue" class="nav">
        <h4 align="center" class="titrenav">Sad but true</h4>
        <a href="./n.html">
        <img id="n" class="imagenav" src="./stickers-logo-metallica.jpg" alt="image">
        </a>
        <p class="txt">Un grand classique qui passe toujours bien.</p>
    </div>
    <div id="unforgiven" class="nav">
        <h4 align="center" class="titrenav">The Unforgiven</h4>
        <a href="./o.html">
        <img id="o" class="imagenav" src="./stickers-logo-metallica.jpg" alt="image">
        </a>
        <p class="txt">Un classique tr√®s appr√©ci√©.</p>
    </div>
    </section>
    <section id="cafesdelamaison">
    <div id="cafes">
        <h4 align="center" class="titrenav">Caf√©s de la maison</h4>
        <a href="./l.html">
        <img id="l" class="imagenav" src="./stickers-logo-metallica.jpg" alt="image">
        </a>
        <p id="txtcaf" class="txt">Divers caf√©s originaux.</p>
    </div>
    </section>
    </section>
    <div id="button" align="center">
    <button id="adminBtn">üîí Acc√®s admin</button>
    </div>
    <div>
      <a id="dcr" href="./liste_commandes.php">
        <button id="liste">Liste des commandes</button>
      </a>
    </div>
    <footer class="footer">
        <h1 align="center" class="titre">Bon app√©tit !</h1>
    </footer>
    <script>
const ADMIN_PASSWORD = "Guinness7";
let etatsCocktails = {};
let modeAdmin = false;

// üîπ Charger les √©tats depuis le JSON
async function chargerCocktails() {
  const res = await fetch("./data/cocktails.json?" + Date.now()); // √©vite le cache
  etatsCocktails = await res.json();
  appliquerEtatCocktails();
  // le bouton global reste cach√© tant que pas admin
  document.getElementById("resetAllBtn").style.display = "none";
}

// üîπ Appliquer les √©tats (afficher / masquer)
function appliquerEtatCocktails() {
  for (const [id, visible] of Object.entries(etatsCocktails)) {
    const element = document.getElementById(id);
    if (element) {
      element.style.display = visible ? "block" : "none";
      const bouton = element.querySelector(".admin-control");
      if (bouton) bouton.textContent = visible ? "üóë Supprimer" : "‚ôª Remettre";
    }
  }
}

// üîπ Sauvegarder dans le fichier JSON via PHP
async function sauvegarderEtats() {
  await fetch("./api/save.php", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(etatsCocktails),
  })
  .then(res => res.json())
  .then(data => console.log("Sauvegarde :", data))
  .catch(err => console.error("Erreur sauvegarde :", err));
}

// üîπ Activation du mode admin
document.getElementById("adminBtn").addEventListener("click", () => {
  const pwd = prompt("Mot de passe admin :");
  if (pwd === ADMIN_PASSWORD) {
    modeAdmin = true;
    activerModeAdmin();
  } else {
    alert("Mot de passe incorrect !");
  }
});

function activerModeAdmin() {
  if (!modeAdmin) return;
  alert("Mode admin activ√© !");
  const navs = document.querySelectorAll(".nav");

  // --- Boutons individuels ---
  navs.forEach(nav => {
    const id = nav.id;
    if (!nav.querySelector(".admin-control")) {
      const btn = document.createElement("button");
      btn.textContent = etatsCocktails[id] ? "üóë Supprimer" : "‚ôª Remettre";
      btn.className = "admin-control";
      btn.style.display = "block";
      btn.style.margin = "10px auto";
      btn.onclick = async () => {
        etatsCocktails[id] = !etatsCocktails[id];
        appliquerEtatCocktails();
        await sauvegarderEtats();
      };
      nav.appendChild(btn);
    }
  });

  // --- Afficher le bouton global ---
  const resetBtn = document.getElementById("resetAllBtn");
  if (resetBtn) resetBtn.style.display = "block";
}

// üîπ R√©initialiser tous les cocktails
async function toutRemettre() {
  if (confirm("Remettre TOUS les cocktails visibles ?")) {
    for (const key in etatsCocktails) {
      etatsCocktails[key] = true;
    }
    appliquerEtatCocktails();
    await sauvegarderEtats();
    alert("Tous les cocktails ont √©t√© r√©activ√©s !");
  }
}

// üîπ Cr√©er le bouton global d√®s le d√©part (mais le cacher)
const globalBtn = document.createElement("button");
globalBtn.id = "resetAllBtn";
globalBtn.textContent = "‚ôª Tout remettre";
globalBtn.className = "admin-global";
globalBtn.style.display = "none"; // cach√© tant que pas admin
globalBtn.onclick = toutRemettre;
document.body.appendChild(globalBtn);

chargerCocktails();
</script>

</body>
</html>